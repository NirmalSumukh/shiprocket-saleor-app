# Fetch products with variants for ShipRocket catalog sync
query FetchProductsForShipRocket(
  $first: Int!
  $after: String
  $channel: String!
) {
  products(first: $first, after: $after, channel: $channel) {
    pageInfo {
      hasNextPage
      endCursor
    }
    totalCount
    edges {
      node {
        id
        name
        description
        slug
        created
        updatedAt
        category {
          name
        }
        defaultVariant {
          id
        }
        thumbnail {
          url
        }
        variants {
          id
          name
          sku
          quantityAvailable
          pricing {
            price {
              gross {
                amount
                currency
              }
            }
          }
          weight {
            value
            unit
          }
          media {
            url
          }
        }
        metadata {
          key
          value
        }
      }
    }
  }
}

# Fetch collections for ShipRocket
query FetchCollectionsForShipRocket(
  $first: Int!
  $after: String
  $channel: String!
) {
  collections(first: $first, after: $after, channel: $channel) {
    pageInfo {
      hasNextPage
      endCursor
    }
    totalCount
    edges {
      node {
        id
        name
        description
        slug
        backgroundImage {
          url
        }
      }
    }
  }
}

# Fetch products by collection ID (kept for backwards compatibility)
query FetchProductsByCollection(
  $collectionId: ID!
  $first: Int!
  $after: String
  $channel: String!
) {
  collection(id: $collectionId, channel: $channel) {
    id
    name
    products(first: $first, after: $after) {
      pageInfo {
        hasNextPage
        endCursor
      }
      totalCount
      edges {
        node {
          id
          name
          description
          slug
          created
          updatedAt
          category {
            name
          }
          thumbnail {
            url
          }
          variants {
            id
            name
            sku
            quantityAvailable
            pricing {
              price {
                gross {
                  amount
                  currency
                }
              }
            }
            weight {
              value
              unit
            }
            media {
              url
            }
          }
        }
      }
    }
  }
}

# Fetch categories as "collections" for ShipRocket
# NOTE: Saleor collections are promotional, so we use categories for product structure
query FetchCategoriesForShipRocket($first: Int!, $after: String, $channel: String!) {
  categories(first: $first, after: $after) {
    pageInfo {
      hasNextPage
      endCursor
    }
    totalCount
    edges {
      node {
        id
        name
        description
        slug
        backgroundImage {
          url
        }
        products(first: 1, channel: $channel) {
          totalCount
        }
      }
    }
  }
}

# Fetch products by category ID
query FetchProductsByCategory(
  $categoryId: ID!
  $first: Int!
  $after: String
  $channel: String!
) {
  category(id: $categoryId) {
    id
    name
    products(first: $first, after: $after, channel: $channel) {
      pageInfo {
        hasNextPage
        endCursor
      }
      totalCount
      edges {
        node {
          id
          name
          description
          slug
          created
          updatedAt
          thumbnail {
            url
          }
          variants {
            id
            name
            sku
            quantityAvailable
            pricing {
              price {
                gross {
                  amount
                  currency
                }
              }
            }
            weight {
              value
              unit
            }
            media {
              url
            }
          }
        }
      }
    }
  }
}
